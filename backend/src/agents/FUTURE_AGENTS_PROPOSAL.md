# Future Agents Proposal - 新Agent方向建议

## 📊 当前Agent覆盖分析

### 已完成的5个Agents（时间维度完整）
| Agent | 时间范围 | 分析类型 | 主要价值 |
|-------|---------|---------|---------|
| PostgameReview | 1场比赛 | 单场复盘 | 即时反馈 |
| DetailedAnalysis | 1个版本 | 深度分析 | 版本掌握度 |
| VersionComparison | 2个版本 | 对比分析 | 适应能力 |
| MultiVersion | 3-5个版本 | 趋势分析 | 短期进步 |
| AnnualSummary | 40-50个版本 | 年度总结 | 长期成长 |

### 覆盖维度
- ✅ **时间维度**: 完整覆盖（单场→年度）
- ✅ **回顾性分析**: 完整覆盖
- ❌ **预测性分析**: 缺失
- ❌ **对比性分析**: 缺失（vs其他玩家）
- ❌ **专项分析**: 缺失（单英雄、单位置）
- ❌ **诊断性分析**: 缺失（弱点识别）
- ❌ **推荐性分析**: 缺失（英雄推荐）

---

## 🚀 推荐的6个新Agent方向

### Priority 1: 高价值 + 数据就绪

#### 1. **ChampionMasteryAgent** - 英雄掌握度分析
**数据范围**: 单个英雄的全部历史数据（跨所有版本）
**核心价值**: 深度掌握度评估 + 学习曲线追踪

**分析维度**:
- **掌握度评分**: 基于胜率稳定性、场次数、版本覆盖率
- **学习曲线**: 首10场 vs 11-30场 vs 30+场的表现变化
- **位置专精度**: 该英雄在不同位置的表现差异
- **版本适应性**: 该英雄在不同meta环境下的表现
- **对局质量**: KDA、参团率、伤害占比等细节指标
- **核心装备路线**: 最优出装组合分析
- **克制关系**: 对线优势/劣势matchup识别

**输出格式**: 2000-3000字报告 + 掌握度评分（S/A/B/C/D）

**技术实现**:
```python
class ChampionMasteryAgent:
    """分析玩家对单个英雄的掌握程度"""

    def run(self, champ_id: int, packs_dir: str) -> Dict[str, Any]:
        # 1. 提取该英雄的所有数据（跨版本）
        # 2. 学习曲线分析（按时间顺序）
        # 3. 位置分析（TOP/JG/MID/ADC/SUP）
        # 4. 版本适应性（patch shock影响）
        # 5. 对局质量统计
        # 6. 生成掌握度评分和报告
        pass
```

**数据需求**: ✅ 现有player-pack数据完全支持

---

#### 2. **RoleSpecializationAgent** - 位置专精分析
**数据范围**: 单个位置的全部历史数据
**核心价值**: 位置掌握度 + 英雄池优化建议

**分析维度**:
- **位置胜率**: 该位置的整体表现
- **英雄池广度**: 该位置使用的英雄数量和分布
- **英雄池深度**: 核心英雄掌握度（30+场的英雄）
- **版本适应**: 该位置在不同meta的表现
- **对线能力**: 早期游戏表现（15min前数据）
- **中后期能力**: 团战和推进能力
- **英雄池gap分析**: 缺少哪些meta英雄

**输出格式**: 2500-3500字报告 + 位置评分 + 英雄推荐

**技术实现**:
```python
class RoleSpecializationAgent:
    """分析玩家在特定位置的专精程度"""

    def run(self, role: str, packs_dir: str) -> Dict[str, Any]:
        # 1. 提取该位置的所有数据
        # 2. 英雄池分析（广度+深度）
        # 3. 对线/中期/后期能力分段
        # 4. 版本适应性分析
        # 5. 识别gap和推荐补充英雄
        pass
```

**数据需求**: ✅ 现有数据支持（by_cr已包含role信息）

---

### Priority 2: 高价值 + 需要额外数据

#### 3. **ProgressTrackerAgent** - 进步追踪分析
**数据范围**: 最近10-20个版本（滚动窗口）
**核心价值**: 量化进步速度 + 识别改进领域

**分析维度**:
- **整体进步趋势**: 胜率、KDA、参团率等核心指标的变化
- **分阶段对比**: 前5个版本 vs 后5个版本
- **单项能力进步**: 对线、团战、推进、视野等
- **学习速度**: 新英雄上手速度
- **稳定性变化**: Wilson CI区间的收窄
- **突破性时刻**: 识别显著进步的版本和原因

**输出格式**: 2000-2500字报告 + 进步速度评分

**技术实现**:
```python
class ProgressTrackerAgent:
    """追踪玩家近期进步趋势"""

    def run(self, packs_dir: str, window_size: int = 10) -> Dict[str, Any]:
        # 1. 滚动窗口分段（前半 vs 后半）
        # 2. 核心指标变化率计算
        # 3. 单项能力进步分析
        # 4. 识别突破性时刻
        # 5. 生成进步报告
        pass
```

**数据需求**: ✅ 现有数据支持（需要timeline数据做更细粒度分析）

---

#### 4. **WeaknessAnalysisAgent** - 弱点诊断分析
**数据范围**: 最近5-10个版本
**核心价值**: 精准识别需要改进的领域

**分析维度**:
- **对线期弱点**: 15min前经济、经验、击杀差距
- **中期决策弱点**: 参团率、支援效率、资源控制
- **团战弱点**: 死亡位置、伤害输出、承伤比
- **视野弱点**: 插眼数、排眼数、视野分数
- **经济弱点**: 补刀效率、参与击杀经济占比
- **英雄池弱点**: 应对meta的英雄储备不足

**输出格式**: 1500-2000字诊断报告 + 改进优先级列表

**技术实现**:
```python
class WeaknessAnalysisAgent:
    """诊断玩家当前的主要弱点"""

    def run(self, packs_dir: str, recent_patches: int = 5) -> Dict[str, Any]:
        # 1. 提取最近N个版本数据
        # 2. 对线期分析（timeline 0-15min）
        # 3. 中期分析（timeline 15-25min）
        # 4. 团战分析（timeline 25min+）
        # 5. 识别薄弱环节
        # 6. 生成改进建议（按优先级排序）
        pass
```

**数据需求**: ⚠️ 需要timeline数据的更细粒度处理

---

### Priority 3: 创新价值 + 需要新数据源

#### 5. **PeerComparisonAgent** - 同段位对比分析
**数据范围**: 玩家数据 vs 同段位平均水平
**核心价值**: 相对定位 + 差距识别

**分析维度**:
- **整体对比**: 胜率、KDA vs 同段位平均
- **英雄池对比**: 英雄掌握度 vs 同段位该英雄平均
- **单项能力对比**: 对线、团战、推进等 vs 平均
- **优势领域**: 显著强于平均的方面
- **劣势领域**: 显著弱于平均的方面
- **段位预测**: 基于表现预测合理段位

**输出格式**: 2000-2500字对比报告 + 段位匹配度评分

**技术实现**:
```python
class PeerComparisonAgent:
    """对比玩家与同段位平均水平"""

    def run(self, packs_dir: str, rank: str, region: str = "na1") -> Dict[str, Any]:
        # 1. 加载玩家数据
        # 2. 从Gold layer查询同段位基准数据
        # 3. 计算各维度差距（z-score）
        # 4. 识别优势和劣势领域
        # 5. 生成对比报告
        pass
```

**数据需求**: ❌ 需要Gold layer的段位基准数据（当前缺失）

---

#### 6. **ChampionRecommendationAgent** - 英雄推荐分析
**数据范围**: 玩家英雄池 + Meta分析
**核心价值**: 基于风格匹配和meta推荐新英雄

**分析维度**:
- **风格识别**: 擅长的英雄类型（刺客/坦克/法师/ADC/辅助）
- **操作模式**: 激进型/稳健型/支援型
- **Meta缺口**: 当前meta强势但玩家未掌握的英雄
- **风格匹配**: 推荐与已掌握英雄相似的新英雄
- **互补推荐**: 推荐能弥补英雄池弱点的英雄
- **学习难度**: 基于玩家学习曲线预测上手速度

**输出格式**: 1500-2000字报告 + Top 5英雄推荐（含理由）

**技术实现**:
```python
class ChampionRecommendationAgent:
    """基于风格和meta推荐新英雄"""

    def run(self, packs_dir: str, current_patch: str) -> Dict[str, Any]:
        # 1. 分析玩家英雄池特征
        # 2. 识别操作风格和偏好
        # 3. 查询当前meta强势英雄
        # 4. 计算风格匹配度
        # 5. 生成推荐列表（含学习建议）
        pass
```

**数据需求**: ⚠️ 需要英雄相似度矩阵和meta tier list

---

## 📋 实现优先级建议

### Phase 1: 立即可做（数据就绪）
1. **ChampionMasteryAgent** - 数据完全支持，价值高
2. **RoleSpecializationAgent** - 数据完全支持，补充位置维度

### Phase 2: 短期实现（需要小幅调整）
3. **ProgressTrackerAgent** - 需要增强timeline处理
4. **WeaknessAnalysisAgent** - 需要更细粒度的timeline分析

### Phase 3: 长期规划（需要新数据）
5. **PeerComparisonAgent** - 需要构建段位基准数据集
6. **ChampionRecommendationAgent** - 需要英雄相似度和meta数据

---

## 🎯 下一步行动建议

### 建议优先实现: **ChampionMasteryAgent**

**理由**:
1. ✅ 数据完全就绪（现有player-pack支持）
2. 📈 用户价值高（深度掌握度分析是玩家刚需）
3. 🔧 实现难度适中（复用现有工具和统计方法）
4. 🎨 补充维度完整（从"时间维度"扩展到"英雄维度"）

**实现步骤**:
1. 创建 `src/agents/player_analysis/champion_mastery/` 目录
2. 设计DESIGN.md（参考AnnualSummaryAgent结构）
3. 实现tools.py（英雄数据聚合和学习曲线分析）
4. 实现prompts.py（2000-3000字报告生成）
5. 实现agent.py（主控制器）
6. 测试（使用test_agents/player_coach/packs数据）

**预期输出示例**:
```markdown
# 英雄掌握度报告 - 亚索 (Yasuo)

## 掌握度评分: A-

**总场次**: 175场（占总游戏52.7%）
**整体胜率**: 58.3% (95% CI: 51.2% - 65.1%)
**版本覆盖**: 9/9个版本（100%）
**主要位置**: 中路（67.6%胜率，37场）

## 学习曲线分析
- 早期（1-30场）: 52.1%胜率，探索期
- 中期（31-100场）: 59.8%胜率，快速提升
- 后期（101+场）: 61.2%胜率，稳定期

## 位置专精
- 中路: A级（67.6%胜率，高度专精）
- 上路: B级（54.2%胜率，偶尔使用）
...
```

---

## 💡 其他潜在方向（低优先级）

- **TeamSynergyAgent**: 分析双排/组队时的协同效果（需要双排数据）
- **TiltDetectionAgent**: 识别连败后的状态下滑（需要时序分析）
- **MacroPlayAgent**: 宏观操作分析（需要地图移动数据）
- **EarlyGameAgent**: 专注对线期分析（需要15min前细节数据）

这些可以作为未来扩展方向，但暂时优先级较低。
